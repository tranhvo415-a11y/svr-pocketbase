# =========================================================
# runner-template env example
# =========================================================
# This file is a reference for required variables.
# Real secrets must be stored in:
# - GitHub Actions secrets
# - Azure Pipelines secret variables / variable groups

# Required: dotenvrtdb endpoint used in CI step `create-env-file`.
DOTENVRTDB_URL=https://your-dotenvrtdb-endpoint

# ---------------------------------------------------------
# Cloudflare tunnel env vars used by `runner-template-createtunnel`
# ---------------------------------------------------------
# Preferred tunnel name key (no suffix):
CLOUDFLARED_TUNNEL_NAME=

# Add many domains with suffixes (00, 01, 02...).
CLOUDFLARED_TUNNEL_DOMAIN_00=
CLOUDFLARED_TUNNEL_DOMAIN_01=
CLOUDFLARED_TUNNEL_DOMAIN_02=

# If a hostname starts with `ssh`, service will map to:
# ssh://127.0.0.1:${SSH_PORT}
SSH_PORT=2222

# ---------------------------------------------------------
# Caddy HTTP origin gateway + Nginx business proxy env vars
# ---------------------------------------------------------
# Caddy now runs as plain HTTP origin behind Cloudflare Tunnel.
# HTTPS/TLS is terminated by Cloudflare edge.

# Upstream app target for Nginx main traffic.
MAIN_PORT=3000
MAIN_TARGET_DNS=127.0.0.1
MAIN_TARGET_PORT=3000
NGINX_PORT=8080

# ---------------------------------------------------------
# PocketBase env vars (used by docker compose service `pocketbase`)
# ---------------------------------------------------------
PB_ADMIN_EMAIL=
PB_ADMIN_PASSWORD=

# Shadow mirror is now file-based:
# - Rules: nginx/maps/mirror_rules.map
# - Shadow upstream list: .nginx/runtime/shadow-servers/<ip>.conf
# - Helper scripts: nginx/scripts/shadow-add.sh, shadow-rm.sh, shadow-sync.sh

# Host-level DNS values (used by CI before docker compose up).
TAILSCALE_DNS_NAMESERVER_PRIMARY=100.100.100.100
TAILSCALE_DNS_NAMESERVER_FALLBACK=1.1.1.1
TAILSCALE_DNS_SEARCH_DOMAIN=

# /files basic auth users (optional, can define many *_00, *_01, ... pairs).
NGINX_AUTH_USER_00=
NGINX_AUTH_PASS_00=
NGINX_AUTH_USER_01=
NGINX_AUTH_PASS_01=

# ---------------------------------------------------------
# docker-manager env vars (dockerapi + tailscale shadow sync)
# ---------------------------------------------------------
DOCKER_MANAGER_PORT=18080
DOCKER_MANAGER_LOG_FILE=docker-manager.log
DOCKER_MANAGER_MAX_BODY_BYTES=65536
DOCKER_MANAGER_COMMAND_TIMEOUT_MS=120000
DOCKER_MANAGER_MAX_LOG_LINES=2000
DOCKER_MANAGER_DEFAULT_LOG_TAIL=200
DOCKER_MANAGER_TAILSCALE_SYNC_ENABLED=1
DOCKER_MANAGER_TAILSCALE_SYNC_INTERVAL_SEC=30
DOCKER_MANAGER_TAILSCALE_CONTAINER=tailscale
DOCKER_MANAGER_NGINX_CONTAINER=nginx
DOCKER_MANAGER_SHADOW_PORT=3000

# Command groups: default full enable
DOCKER_MANAGER_ENABLE_SAFE_COMMANDS=1
DOCKER_MANAGER_ENABLE_DANGEROUS_COMMANDS=1
DOCKER_MANAGER_ALLOWED_SAFE_COMMANDS=*
DOCKER_MANAGER_ALLOWED_DANGEROUS_COMMANDS=*
DOCKER_MANAGER_BLOCKED_COMMANDS=
DOCKER_MANAGER_EXEC_SHELL=sh

# ---------------------------------------------------------
# Pull-data env vars used by docker compose service `pull-data`
# ---------------------------------------------------------
# Comma-separated directories to sync from remote cwd.
PULL_DATA_SYNC_DIRS=.pocketbase

# ---------------------------------------------------------
# Tailscale Access Controls env vars used by `runner-template-tailscale`
# ---------------------------------------------------------
# Auth option 1: OAuth client credentials (TS_* aliases are also supported)
TAILSCALE_CLIENT_ID=
TAILSCALE_CLIENT_SECRET=

# Optional: tailnet slug/domain for endpoint /tailnet/{tailnet}/acl
# Use "-" for current/default tailnet.
TAILSCALE_TAILNET=-

# Optional: custom ACL hujson path (relative to cwd or absolute).
TAILSCALE_ACL_BODY_FILE=./tailscale/access-controls.hujson

# Optional: OAuth scope + API request tuning.
TAILSCALE_OAUTH_SCOPE=
TAILSCALE_API_BASE_URL=https://api.tailscale.com
TAILSCALE_API_TIMEOUT_MS=30000

# ---------------------------------------------------------
# Keys expected to exist in DotenvRTDB storage
# ---------------------------------------------------------
# Raw JSON content, written to ./cloudflared-credentials.json
CLOUDFLARED_CREDENTIALS_JSON_BASE64=
# Base64 encoded YAML, written to ./cloudflared-config.yml
CLOUDFLARED_CONFIG_YML_BASE64=

# Base64 encoded YAML, written to ./docker-compose.yml
DOCKER_COMPOSE_YML_BASE64=

# ---------------------------------------------------------
# Optional examples
# ---------------------------------------------------------
APP_ENV=dev
REGION=ap-southeast-1

# Runner keep-alive sample values (if needed by your app scripts)
RUNNER_KEEP_ALIVE_INTERVAL=60
RUNNER_KEEP_ALIVE_SERVICES=docker
